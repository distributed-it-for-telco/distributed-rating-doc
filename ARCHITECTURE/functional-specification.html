<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Functional Specification - Distributed Rating Engine with wasmCloud</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././mdbook-admonish.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "light" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../about.html">About</a></li><li class="chapter-item expanded affix "><li class="part-title">Concepts</li><li class="chapter-item expanded "><a href="../CONCEPTS/concepts.html"><strong aria-hidden="true">1.</strong> Concepts</a></li><li class="chapter-item expanded affix "><li class="part-title">Architecture</li><li class="chapter-item expanded "><a href="../ARCHITECTURE/architecture.html"><strong aria-hidden="true">2.</strong> Software Architecture</a></li><li class="chapter-item expanded "><a href="../ARCHITECTURE/functional-specification.html" class="active"><strong aria-hidden="true">3.</strong> Functional Specification</a></li><li class="chapter-item expanded affix "><li class="part-title">Use Cases</li><li class="chapter-item expanded "><a href="../USE-CASES/UC-01/index.html"><strong aria-hidden="true">4.</strong> UC-01: Customer product inventory</a></li><li class="chapter-item expanded "><a href="../USE-CASES/UC-03/index.html"><strong aria-hidden="true">5.</strong> UC-03: Rate usage - Regular</a></li><li class="chapter-item expanded "><a href="../USE-CASES/UC-04/index.html"><strong aria-hidden="true">6.</strong> UC-04: Rate usage - Threshold</a></li><li class="chapter-item expanded "><a href="../USE-CASES/UC-05/index.html"><strong aria-hidden="true">7.</strong> UC-05: Rate usage - Bundle</a></li><li class="chapter-item expanded affix "><li class="part-title">Architecture decision records</li><li class="chapter-item expanded "><a href="../ADR/ard001-monorepo_code_organization.html"><strong aria-hidden="true">8.</strong> Monorepo code organization</a></li><li class="chapter-item expanded affix "><li class="part-title">How-to</li><li class="chapter-item expanded "><a href="../HOW-TO/kickstart.html"><strong aria-hidden="true">9.</strong> WasmCloud Kickstart</a></li><li class="chapter-item expanded "><a href="../HOW-TO/smithy-notes.html"><strong aria-hidden="true">10.</strong> Smithy</a></li><li class="chapter-item expanded affix "><li class="part-title">Handbook</li><li class="chapter-item expanded "><a href="../HANDBOOK/kv-store-management.html"><strong aria-hidden="true">11.</strong> Key-Value store management</a></li><li class="chapter-item expanded "><a href="../HANDBOOK/link-management.html"><strong aria-hidden="true">12.</strong> Link management</a></li><li class="chapter-item expanded "><a href="../HANDBOOK/shutdown-host.html"><strong aria-hidden="true">13.</strong> Shutdown host</a></li><li class="chapter-item expanded affix "><li class="part-title">Archives</li><li class="chapter-item expanded "><a href="../ARCHIVE/rationale.html"><strong aria-hidden="true">14.</strong> Rationale</a></li><li class="chapter-item expanded "><a href="../ARCHIVE/requirements.html"><strong aria-hidden="true">15.</strong> Requirements</a></li><li class="chapter-item expanded "><a href="../ARCHIVE/model.html"><strong aria-hidden="true">16.</strong> Model</a></li><li class="chapter-item expanded "><a href="../ARCHIVE/model-solution1.html"><strong aria-hidden="true">17.</strong> Solution 1</a></li><li class="chapter-item expanded "><a href="../ARCHIVE/about-wasmcloud.html"><strong aria-hidden="true">18.</strong> About wasmCloud</a></li><li class="chapter-item expanded "><a href="../ARCHIVE/architecture.html"><strong aria-hidden="true">19.</strong> wasmCloud Architecture</a></li><li class="chapter-item expanded "><a href="../ARCHIVE/prototype-architecture.html"><strong aria-hidden="true">20.</strong> Prototype Architecture</a></li><li class="chapter-item expanded "><a href="../ARCHIVE/technical-requirements.html"><strong aria-hidden="true">21.</strong> Technical requirements</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Distributed Rating Engine with wasmCloud</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/distributed-it-for-telco" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/distributed-it-for-telco/distributed-rating-doc/edit/main/src/ARCHITECTURE/functional-specification.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="functional-specification"><a class="header" href="#functional-specification">Functional Specification</a></h1>
<p><strong>TABLE OF CONTENT</strong></p>
<ul>
<li><a href="#introduction">Introduction</a>
<ul>
<li><a href="#context">Context</a></li>
<li><a href="#assumptions">Assumptions</a></li>
</ul>
</li>
<li><a href="#charging--billing">Charging &amp; Billing</a></li>
<li><a href="#charging-and-billing-within-etom">Charging and Billing within eTOM</a>
<ul>
<li><a href="#product-usage-management">Product Usage Management</a></li>
<li><a href="#product-rating--rate-assignment">Product Rating &amp; Rate Assignment</a></li>
<li><a href="#product-balance-management">Product Balance Management</a></li>
<li><a href="#bill-calculation">Bill Calculation</a></li>
<li><a href="#managed-entities">Managed entities</a>
<ul>
<li><a href="#customer-product-inventory">Customer Product Inventory</a></li>
<li><a href="#rated-usage-inventory">Rated Usage Inventory</a></li>
</ul>
</li>
<li><a href="#system-personas">System Personas</a>
<ul>
<li><a href="#customer">Customer</a></li>
<li><a href="#vendor">Vendor</a></li>
<li><a href="#provider">Provider</a></li>
<li><a href="#partner">Partner</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="introduction"><a class="header" href="#introduction">Introduction</a></h2>
<p>The aim of this page is to describe the business aspects for the distributed charging and rating process. The specification should try to describe when possible the similarities between the distributed rating and the charging and billing components in TMF.</p>
<h3 id="context"><a class="header" href="#context">Context</a></h3>
<p>Distributed Rating aims to explore the use of distributed architecture for the rating and part of the charging process to optimize the utilization of the various infrastructure components. For reference the software architecture for the stream can be found <a href="./architecture.html">here</a>.</p>
<h3 id="assumptions"><a class="header" href="#assumptions">Assumptions</a></h3>
<p>Given the fact that this part is a research activity, this component will aim to comply with the TMF guidelines while allowing room for the needs of its innovative nature. in the first evolution the system may mock any external components to expedite the research activities.</p>
<p>The first evolution should focus on products provided over IP through a client application to facilitate the tracking of their usage through the client application.</p>
<h2 id="charging--billing"><a class="header" href="#charging--billing">Charging &amp; Billing</a></h2>
<p><img src="./charging_billing_overview.svg" alt="Charging &amp; Billing BPM" /></p>
<p>The process called &quot;Billing&quot; consists of a set of different processes, each working on one type of data:</p>
<ul>
<li><strong>Charging</strong>
in charge of controlling the usage and decrementation of bundles. It is part of the &quot;Factory&quot; platform and uses the Charging rules and features described at the Product level.</li>
<li><strong>Rating</strong>
which valuates the usage tickets sent by the Charging. It is part of the &quot;Offer &amp; Products&quot; platform and uses the tariffs and tariff plans described in the Offers to determine the tariff codes (InstalledTariff) that will be used to make the invoice.</li>
<li><strong>Bill</strong>
alculation, which calculates the billable items (AppliedTariff) that will be sent to billing to be put on the bill. It is part of the &quot;Offer &amp; Products&quot; platform and uses the rates and tariff plan described in the Offers</li>
<li><strong>Invoicing</strong>
which establishes the invoice from billable items received. It is part of the &quot;Party&quot; platform and uses commercial catalog information to calculate invoice elements and layout.</li>
</ul>
<p>Part of the charging and rating will be distributed in the new architecture, the rating component should then feed the generated tariff to the billing component. There's no direct impact from the invoicing component so it will not be discussed in this document's scope.</p>
<h2 id="charging-and-billing-within-etom"><a class="header" href="#charging-and-billing-within-etom">Charging and Billing within eTOM</a></h2>
<p>Below are listed level 2 business processes that are related to Product rating &amp; Bill Calculation from within the eTOM business process framework, these processes should be used as a guide while distributing the operations on the new architecture.</p>
<h3 id="product-usage-management"><a class="header" href="#product-usage-management">Product Usage Management</a></h3>
<p>The Product Usage management processes encompass the functions required to guide, distribute, mediate, summarize, accumulate, and analyze Product Usage records. These processes may occur in real-time, near real-time (i.e. just at the end of the usage), or may be executed on a periodic basis.</p>
<p>Conventionally the usage is collected on the network component and forwarded to be processed in the usage management component.</p>
<p>In the distributed rating, the Client SDK should do the usage collection and forward it to the rating agent to be processed in real-time.</p>
<p>Below is the data schema of the product usage management as defined in TMF-635, the main entity used in the usage management process is the Usage and UsageSpecification</p>
<pre class="mermaid">%%{init: {'theme': 'base', 'themeVariables': {
  'lineColor': '#a8201a',
  'primaryColor': '#fae5c7',
  'primaryBorderColor': '#0f8b8d'
}}}%%
classDiagram
  direction LR
  class RelatedParty{
    URI href
    String id
    String name
    String role
    String @type
    String @baseType
    String @referredType
    URI @schemaLocation
  }
  class UsageSpecificationRef{
    URI href
    String id
    String name
    String @type
    String @baseType
    String @referredType
    URI @schemaLocation
  }
  class Usage{
    URI href
    String id
    String usageType
    Date usageDate
    UsageStatusType status
    String @type
    String @baseType
    URI @schemaLocation
  }
  class UsageStatusType{
    &lt;&lt;Enumeration&gt;&gt;
    received
    rejected
    recycled
    guided
    rated
    rerated
  }
  class UsageCharacteristic{
    String id
    String name
    String valueType
    Any value
    String @type
    String @baseType
    URI @schemaLocation
  }
  class CharacteristicRelationship{
    URI href
    String id
    String relationshipType
    String @type
    String @baseType
    URI @schemaLocation
  }
  RelatedParty &quot;0..*&quot; &lt;--* Usage
  UsageSpecificationRef &quot;0..1&quot; &lt;--* Usage
  Usage -- &quot;1&quot; UsageStatusType
  Usage *--&gt; &quot;0..*&quot; UsageCharacteristic
  UsageCharacteristic *--&gt; &quot;0..*&quot; CharacteristicRelationship
</pre>
<h3 id="product-rating--rate-assignment"><a class="header" href="#product-rating--rate-assignment">Product Rating &amp; Rate Assignment</a></h3>
<p>The purpose of Product Rating &amp; Assignment is to rate a value (monetary or other) to Product Usage or a set of Product Usages and assign the result to a Product and a Billing Account. The charge may be either a credit or a debit and can be handled either online or offline.</p>
<p>Online charging is performed in real-time, necessitating an authorization component that can impact the delivery of the product and enables the operator to provide prepaid products to their customers. Conversely, offline charging takes place after the product has been delivered and does not necessitate real-time processing, and typically pertains to subscription-based products.</p>
<p>in the distributed rating, optimally the process of usage and rating should be done on the edge or the FOG levels to minimize the loud on the infrastructure.</p>
<p>Below is the data schema of the product usage management as defined in TMF-635, the main entity used in the product rating and rate assignment process is the RatedProductUsage entity</p>
<pre class="mermaid">%%{init: {'theme': 'base', 'themeVariables': {
  'lineColor': '#a8201a',
  'primaryColor': '#fae5c7',
  'primaryBorderColor': '#0f8b8d'
}}}%%
classDiagram
  direction LR
  class RelatedParty{
    URI href
    String id
    String name
    String role
    String @type
    String @baseType
    String @referredType
    URI @schemaLocation
  }
  class UsageSpecificationRef{
    URI href
    String id
    String name
    String @type
    String @baseType
    String @referredType
    URI @schemaLocation
  }
  class Usage{
    URI href
    String id
    String usageType
    Date usageDate
    UsageStatusType status
    String @type
    String @baseType
    URI @schemaLocation
  }
  class UsageCharacteristic{
    String id
    String name
    String valueType
    Any value
    String @type
    String @baseType
    URI @schemaLocation
  }
  class CharacteristicRelationship{
    URI href
    String id
    String relationshipType
    String @type
    String @baseType
    URI @schemaLocation
  }
  class UsageStatusType{
    &lt;&lt;Enumeration&gt;&gt;
    received
    rejected
    recycled
    guided
    rated
    rerated
  }
  class RatedProductUsage{
    Money bucketValueConvertedInAmount
    bool isBilled
    bool isTaxExempted
    String offerTariffType
    String ratingAmountType
    Date ratingDate
    Money taxExcludedRatingAmount
    Money taxIncludedRatingAmount
    float taxRate
    String usageRatingTag
    String @type
    String @baseType
    URI @schemaLocation
  }
  class ProductRef{
    URI href
    String id
    String name
    String @type
    String @baseType
    String @referredType
    URI @schemaLocation
  }
  RelatedParty &quot;0..*&quot; &lt;--* Usage
  UsageSpecificationRef &quot;0..1&quot; &lt;--* Usage
  Usage -- &quot;1&quot; UsageStatusType
  Usage *--&gt; &quot;0..*&quot; UsageCharacteristic
  Usage *--&gt; &quot;0..*&quot; RatedProductUsage
  UsageCharacteristic *--&gt; &quot;0..*&quot; CharacteristicRelationship
  RatedProductUsage *--&gt; &quot;0..1&quot; ProductRef
</pre>
<h3 id="product-balance-management"><a class="header" href="#product-balance-management">Product Balance Management</a></h3>
<p>This process is responsible for holding, calculating, applying policies and managing functionality/interfaces for the Product balances, Here the values resulting from rating and the application of discounts are applied to a Product balance. The balance affected by the value may be monetary or other balances such as minutes, points, or tokens.</p>
<p>The rating agent should ensure that the balance is impacted and reduce it to match the product usage. The aim is to ensure that the balance is impacted instantly and is managed in a distributed manner. The operations for balance management (like top-up operations) will be out of scope of the first evolution and only the reduction of balance based on usage will be represented.</p>
<p>Below is the data schema of the balance as defined in TMF-654</p>
<pre class="mermaid">%%{init: {'theme': 'base', 'themeVariables': {
  'lineColor': '#a8201a',
  'primaryColor': '#fae5c7',
  'primaryBorderColor': '#0f8b8d'
}}}%%
classDiagram
  direction LR
  class PartyAccountRef{
    String id
    String href
    String name
  }
  class RelatedPartyRef{
    String id
    String href
    String role
    String name
  }
  class BucketBalance{
    [ SID CustomerAccountBalance ]
    String id
    String href
    String name
    String discription
    String bucketType
    TimePeriod validFor
    Quantity remainedAmount
    Quantity reservedAmount
    String status
  }
  class RealizingResourceRef{
    String id
    String href
    String name
    String @type
    String value
  }
  class ProductRef{
    String id
    String href
    String name
  }
  PartyAccountRef &quot;1&quot; --o &quot;1&quot; BucketBalance
  RelatedPartyRef &quot;0..*&quot; --o &quot;1&quot; BucketBalance
  BucketBalance &quot;1&quot; o-- &quot;0..*&quot; RealizingResourceRef
  BucketBalance &quot;1&quot; o-- &quot;0..*&quot; ProductRef
  RealizingResourceRef &quot;*&quot; -- &quot;1&quot; ProductRef
</pre>
<h3 id="bill-calculation"><a class="header" href="#bill-calculation">Bill Calculation</a></h3>
<p>Customer Bill Invoice Management processes ensure the bill invoice is created, physically and/or electronically produced and distributed to customers, and that the appropriate taxes, discounts, adjustments, rebates and credits for the products delivered to customers have been applied. These processes are accountable for assuring that enterprise revenue is billed and invoices delivered appropriately to customers.</p>
<p>These processes are responsible for, but not limited to:</p>
<ul>
<li>Establishment and application of taxes and charges to the products delivered to customers;</li>
<li>Application of the adjustment (adjustment decision done in Customer Bill Inquiry Handling);</li>
<li>Creation of accurate Customer bill invoices including all adjustments, rebates, discounts, credits, etc.</li>
<li>Production &amp; distribution of Customer bill in physical and/or electronic form to customers in accordance with the billing cycle;</li>
<li>Forecasting of physical resources associated with Customer bill production, such as paper and envelope quantities;</li>
<li>Alignment and management of promotional material insertion into distributed Customer bills</li>
<li>Establishment and management of third party arrangements to support Customer bill invoice generation, production and distribution.</li>
</ul>
<p>The implementation of the Bill Calculation component is out of scope of the distributed rating however the system should ensure that it can generate Proof of Usages and rated events that can be forwarded to the Bill calculation component - through events or shared storage - to support post paid business scenarios. The support for aggregated rating will not be addressed in the first release and can be included in later evolution due to the technical complexity associated with it.</p>
<h3 id="managed-entities"><a class="header" href="#managed-entities">Managed entities</a></h3>
<h4 id="customer-product-inventory"><a class="header" href="#customer-product-inventory">Customer Product Inventory</a></h4>
<p>The customer product inventory component holds the information about the customer and his installed products. it's used to track all the products that the customer has subscribed to as well as their cost. in the first release the customer inventory will be a simple key-value store that holds the customer id as the key and party information with a list of their installed product in the value. the figure below show the schema of the data stored in the value.</p>
<pre class="mermaid">%%{init: {'theme': 'base', 'themeVariables': {
  'lineColor': '#a8201a',
  'primaryColor': '#fae5c7',
  'primaryBorderColor': '#0f8b8d'
}}}%%
classDiagram
  direction LR
  class Party {
    string id
    string name
  }
  class CustomerInventory {
    Party relatedParty
    List~Product~ products
  }
  class ProductOfferingRef {
    string id
    string name
    string agentId
    Quantity unitOfMeasure
  }
  class Quantity {
    string amount
    string units
  }
  class Product {
    string id
    string partnerId
    string description
    ProductOfferingRef productOffering
    ProductPrice productPrice
  }
  class ProductPrice {
    PriceType priceType
    DataTime validTill
    string description
    Quantity unitOfMeasure
    Price price
  }
  class PriceType {
    &lt;&lt;Enumeration&gt;&gt;
    recurring
    none-recurring
    penalty
    one-time
  }
  class Price {
    string unit
    float value
  }
  Party --o CustomerInventory
  CustomerInventory *-- Product
  ProductOfferingRef --o Product
  ProductOfferingRef *-- Quantity
  Product o-- ProductPrice
  Quantity --* ProductPrice
  ProductPrice o-- PriceType
  ProductPrice *-- Price
</pre>
<p>productPrice: An amount, usually of money, that represents the actual price paid by a Customer for a purchase, a rent or a lease of a Product. The price is valid for a defined period of time.
price: A money (Money). The amount of money that characterizes the price.</p>
<p>Money sub-resource
A base / value business entity used to represent money.
unit: A string. Currency (ISO4217 norm uses 3 letters to define the currency).
value: A float. A positive floating point number.</p>
<details id="admonition-customer-product-inventory-field-descriptions" class="admonition admonish-abstract">
<summary class="admonition-title">
<p>Customer product inventory field descriptions</p>
<p><a class="admonition-anchor-link" href="#admonition-customer-product-inventory-field-descriptions"></a></p>
</summary>
<div>
<p>RelatedParty sub-resource:
Related Entity reference. A related party defines party or party role linked to a specific entity.</p>
<ul>
<li>name: A string. Name of the related entity.</li>
<li>id: A string. unique identifier.</li>
</ul>
<p>productOffering A product offering reference (ProductOfferingRef). A product offering represents entities that are orderable from the provider of the catalog.</p>
<ul>
<li>name: A string. Name of the related entity.</li>
<li>id: A string. unique identifier.</li>
<li>agentId: the identifier for the agent in charge of rating this offer</li>
</ul>
<p>productPrice: An amount, usually of money, that represents the actual price paid by a Customer for a purchase, a rent or a lease of a Product. The price is valid for a defined period of time.</p>
<ul>
<li>price: A money (Money). The amount of money that characterizes the price.</li>
<li>priceType: A string. A category that describes the price charge, such as recurring, penalty, One time fee and so forth.</li>
<li>unitOfMeasure A quantity (Quantity). A number and unit representing how many (for instance 1 dozen) of an ProductOffering is available at the offered price. Its meaning depends on the priceType. It could be a price, a rate, or a discount.</li>
</ul>
<p>Money sub-resource:
A base / value business entity used to represent money.</p>
<ul>
<li>unit: A string. Currency (ISO4217 norm uses 3 letters to define the currency).</li>
<li>value: A float. A positive floating point number.</li>
</ul>
</div>
</details>
<h4 id="rated-usage-inventory"><a class="header" href="#rated-usage-inventory">Rated Usage Inventory</a></h4>
<p>The rated usage inventory component holds the information about the customer's consumption and its associated cost. it's used to hold the rated usage information that can be forwarded later on to the billing component. the figure below show the schema of the rated usage.</p>
<pre class="mermaid">%%{init: {'theme': 'base', 'themeVariables': {
  'lineColor': '#a8201a',
  'primaryColor': '#fae5c7',
  'primaryBorderColor': '#0f8b8d'
}}}%%
classDiagram
  direction TB
  class Party {
    string id
    string name
    string role
    string @referredType
  }
  class RatedUsage {
    string id
    string usageDate
    string description
    string usageType
    string status
    Party relatedParty
    RatedProductUsage ratedProductUsage
    List~UsageCharacteristic~ usageCharacteristics
  }
  class UsageCharacteristic {
    string id
    string name
    string valueType
    string value
  }
  class RatedProductUsage {
    bool isBilled
    string ratingAmountType
    string ratingDate
    BucketValueConvertedInAmount bucketValueConvertedInAmount
    ProductRef productRef
  }
  class BucketValueConvertedInAmount {
    string unit
    int value
  }
  class ProductRef {
    string id
    string name
  }
  Party --o RatedUsage
  UsageCharacteristic --* RatedUsage
  RatedUsage *-- RatedProductUsage
  RatedProductUsage o-- ProductRef
  RatedProductUsage o-- BucketValueConvertedInAmount
</pre>
<details id="admonition-rated-usage-inventory-field-descriptions" class="admonition admonish-abstract">
<summary class="admonition-title">
<p>Rated usage inventory field descriptions</p>
<p><a class="admonition-anchor-link" href="#admonition-rated-usage-inventory-field-descriptions"></a></p>
</summary>
<div>
<p>RatedUsage fields:</p>
<ul>
<li>id: A string. unique identifier.</li>
<li>usageDate: A date time (DateTime). Date of usage.</li>
<li>description:  A string. Description of usage.</li>
<li>ratedProductUsage: rated product usages (RatedProductUsage). An occurrence of employing a product for its intended purpose with all rating details.</li>
<li>relatedParty: related party (RelatedParty ). Related Entity reference. A related party defines party or party role linked to a specific entity.</li>
<li>status: A usage status type (UsageStatusType). Possible values for the status of the Usage.</li>
<li>usageCharacteristic: A list of usage characteristics (UsageCharacteristic [*]). Provides the value of a given characteristic.</li>
<li>usageType: A string. Type of usage.</li>
</ul>
<p>Money sub-resource:
A base / value business entity used to represent money.</p>
<ul>
<li>unit: A string. Currency (ISO4217 norm uses 3 letters to define the currency).</li>
<li>value: A float. A positive floating point number.</li>
</ul>
<p>RatedProductUsage sub-resource:
An occurrence of employing a product for its intended purpose with all rating details.</p>
<ul>
<li>bucketValueConvertedInAmount: A money (Money). A base / value business entity used to represent money.</li>
<li>isBilled: A boolean. Boolean indicating if usage have been billed or not.</li>
<li>productRef: A product reference (ProductRef).</li>
<li>ratingAmountType: A string. Type of amount.</li>
<li>ratingDate: A date time (DateTime). Date of usage rating.</li>
<li>usageRatingTag A string. Tag value: [usage]: the usage is always rated outside a usage bundle [included usage]: the usage is rated inside a usage bundle, [non included usage]: the usage bundle is exhausted. The usage is rated outside the usage bundle.</li>
</ul>
<p>RelatedParty sub-resource:
Related Entity reference. A related party defines party or party role linked to a specific entity.</p>
<ul>
<li>name A string. Name of the related entity.</li>
<li>id A string. unique identifier.</li>
<li>role A string. Role played by the related party.</li>
</ul>
<p>UsageCharacteristic sub-resource:
Provides the value of a given characteristic.</p>
<ul>
<li>id: A string. Unique identifier of the characteristic.</li>
<li>name: A string. Name of the characteristic.</li>
<li>valueType: A string. Data type of the value of the characteristic.</li>
</ul>
</div>
</details>
<h3 id="system-personas"><a class="header" href="#system-personas">System Personas</a></h3>
<h4 id="customer"><a class="header" href="#customer">Customer</a></h4>
<p>The end user that is benefiting from the product irrespective of his relation with different entities involved.</p>
<div id="admonition-customer-example" class="admonition admonish-example">
<div class="admonition-title">
<p>Customer Example</p>
<p><a class="admonition-anchor-link" href="#admonition-customer-example"></a></p>
</div>
<div>
<ul>
<li>Person requesting to watch a movie on a streaming provider through his teleco account.</li>
<li>Person requesting to consume a hosting products from a cloud provider which relies on a teleco products for connectivity</li>
</ul>
</div>
</div>
<h4 id="vendor"><a class="header" href="#vendor">Vendor</a></h4>
<p>The entity that's managing the customer account. a vendor can be reselling a product, building a composite product or providing his own products as well.</p>
<p>Depending on the usecase the same entity can be regarded as vendor, provider or a partner.</p>
<h4 id="provider"><a class="header" href="#provider">Provider</a></h4>
<p>The entity providing their products for partners with a revenue sharing model. providers can also be represented as the Vendor in case of selling directly yo the Customer.</p>
<h4 id="partner"><a class="header" href="#partner">Partner</a></h4>
<p>Describes the relation between Vendors and providers, providers are considered a partner for the vendor that's reselling/composing their products. Providers are also considered partners to other providers if the use other products.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../ARCHITECTURE/architecture.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../USE-CASES/UC-01/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../ARCHITECTURE/architecture.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../USE-CASES/UC-01/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>


    </div>
    </body>
</html>
